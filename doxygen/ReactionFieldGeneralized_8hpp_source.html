<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ESPResSo++: /home/travis/build/espressopp/espressopp/src/interaction/ReactionFieldGeneralized.hpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo++
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>      </li>
      <li class="navelem"><a class="el" href="dir_bacb04149764cbf6394e26ac332ca39a.html">travis</a>      </li>
      <li class="navelem"><a class="el" href="dir_658dffd2684749c363737148727fc8b1.html">build</a>      </li>
      <li class="navelem"><a class="el" href="dir_5c08f133502774d40ee791d106d3c75a.html">espressopp</a>      </li>
      <li class="navelem"><a class="el" href="dir_805259ce9380bb65a7430128d5e0f497.html">espressopp</a>      </li>
      <li class="navelem"><a class="el" href="dir_840424569f8391225c4dad9612f75a9e.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_725c2a7b72c128cc0e599137c784e518.html">interaction</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ReactionFieldGeneralized.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ReactionFieldGeneralized_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">  Copyright (C) 2012,2013</span>
<a name="l00003"></a>00003 <span class="comment">      Max Planck Institute for Polymer Research</span>
<a name="l00004"></a>00004 <span class="comment">  Copyright (C) 2008,2009,2010,2011</span>
<a name="l00005"></a>00005 <span class="comment">      Max-Planck-Institute for Polymer Research &amp; Fraunhofer SCAI</span>
<a name="l00006"></a>00006 <span class="comment">  </span>
<a name="l00007"></a>00007 <span class="comment">  This file is part of ESPResSo++.</span>
<a name="l00008"></a>00008 <span class="comment">  </span>
<a name="l00009"></a>00009 <span class="comment">  ESPResSo++ is free software: you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
<a name="l00011"></a>00011 <span class="comment">  the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00012"></a>00012 <span class="comment">  (at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment">  </span>
<a name="l00014"></a>00014 <span class="comment">  ESPResSo++ is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment">  GNU General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment">  </span>
<a name="l00019"></a>00019 <span class="comment">  You should have received a copy of the GNU General Public License</span>
<a name="l00020"></a>00020 <span class="comment">  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. </span>
<a name="l00021"></a>00021 <span class="comment">*/</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">// ESPP_CLASS</span>
<a name="l00024"></a>00024 <span class="preprocessor">#ifndef _INTERACTION_REACTIONFIELDGENERALIZED_HPP</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#define _INTERACTION_REACTIONFIELDGENERALIZED_HPP</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="Potential_8hpp.html">Potential.hpp</a>&quot;</span>
<a name="l00028"></a>00028 <span class="comment">//#include &quot;FixedPairListInteractionTemplate.hpp&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">using namespace </span>std;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="keyword">namespace </span>espressopp {
<a name="l00033"></a>00033     <span class="keyword">namespace </span>interaction {
<a name="l00034"></a>00034         <span class="comment">/*</span>
<a name="l00035"></a>00035 <span class="comment">         * This class provides methods to compute forces and energies of</span>
<a name="l00036"></a>00036 <span class="comment">         * the generalized reaction field</span>
<a name="l00037"></a>00037 <span class="comment">         */</span>
<a name="l00038"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html">00038</a>         <span class="keyword">class </span><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html">ReactionFieldGeneralized</a>: <span class="keyword">public</span>
<a name="l00039"></a>00039         <a class="code" href="classespressopp_1_1interaction_1_1PotentialTemplate.html" title="Provides a template for the simple implementation of a shifted, absolute distance dependent potential...">PotentialTemplate</a>&lt;ReactionFieldGeneralized&gt; {
<a name="l00040"></a>00040             <span class="keyword">private</span>:
<a name="l00041"></a>00041                 <span class="comment">//real qq; // p1.q() * p2.q()</span>
<a name="l00042"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a2244015d18b9390b3537ee6f151efcd9">00042</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a2244015d18b9390b3537ee6f151efcd9">kappa</a>;
<a name="l00043"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a83bf3b49dca41f18e01a6845b365187c">00043</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> epsilon1, <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a83bf3b49dca41f18e01a6845b365187c">epsilon2</a>;
<a name="l00044"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a54da7a11c087a14f8e988e23ee5d9b6c">00044</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> rc, <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a54da7a11c087a14f8e988e23ee5d9b6c">rc3</a>; <span class="comment">// cutoff, cutoff^3</span>
<a name="l00045"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a5366729be2d7b6f8ee2bc06794840b9a">00045</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a5366729be2d7b6f8ee2bc06794840b9a">rc2</a>;
<a name="l00046"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a592ecc7a26653141addeb367ba7f66f7">00046</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> B1, B0, <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a592ecc7a26653141addeb367ba7f66f7">B1_half</a>;
<a name="l00047"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#abb657077aa4ff1bf91db4cd4bb024504">00047</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#abb657077aa4ff1bf91db4cd4bb024504">prefactor</a>;
<a name="l00048"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#aaaaa38dbaf24b2cd6330a943a478630c">00048</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#aaaaa38dbaf24b2cd6330a943a478630c">crf</a>; <span class="comment">/* const to make potential zero at cutoff, corresponding</span>
<a name="l00049"></a>00049 <span class="comment">                 to the shift, which we cannot use because it depends on qq*/</span>
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a3d511d65cf56aedb2949ce2994790488">00051</a>                 <span class="keywordtype">void</span> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a3d511d65cf56aedb2949ce2994790488">initialize</a>() {
<a name="l00052"></a>00052                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> krc = kappa*rc;
<a name="l00053"></a>00053                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> tmp1 = (epsilon1 - 4.0*epsilon2) *
<a name="l00054"></a>00054                             (1.0 + krc) - 2.0*epsilon2 * krc*krc;
<a name="l00055"></a>00055                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> tmp2 = (epsilon1 + 2.0*epsilon2) *
<a name="l00056"></a>00056                             (1.0 + krc) + epsilon2 * krc*krc;
<a name="l00057"></a>00057                     rc3 = pow(rc,3);
<a name="l00058"></a>00058                     rc2 = pow(rc,2);
<a name="l00059"></a>00059                     B1 = tmp1/tmp2;
<a name="l00060"></a>00060                     B1 = (1.0+B1) / rc3;
<a name="l00061"></a>00061                     B1_half = B1/2.0;
<a name="l00062"></a>00062                     <span class="comment">//B0 = (epsilon1 - 2.0*epsilon2 * (1.0+krc))/(epsilon2*(1.0+krc));</span>
<a name="l00063"></a>00063                     crf = 3*epsilon2/(rc*(2*epsilon2+1.0));
<a name="l00064"></a>00064                     <span class="comment">//B0 = (1.0+B0) / rc;</span>
<a name="l00065"></a>00065                     prefactor/=epsilon1;
<a name="l00066"></a>00066                 }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068             <span class="keyword">public</span>:
<a name="l00069"></a>00069                 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespaceespressopp_1_1analysis.html#a28a2d26f3ec5c6a83732697b582fd664">registerPython</a>();
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a8fc696e8373a8db8abcec21b2f4f6f85">00071</a>                 <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html">ReactionFieldGeneralized</a>()
<a name="l00072"></a>00072                 : prefactor(1), kappa(0.0),
<a name="l00073"></a>00073                  epsilon1(1.0), epsilon2(80.0),
<a name="l00074"></a>00074                  rc(1.0){
<a name="l00075"></a>00075                     setShift(0.0);
<a name="l00076"></a>00076                     setCutoff(<a class="code" href="namespaceespressopp.html#a17073f3a1f37696e5162420c324eb4ca">infinity</a>);
<a name="l00077"></a>00077                     initialize();
<a name="l00078"></a>00078                 }
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ae7ad46f7fe2db72ef7e0bf0419c34590">00080</a>                 <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html">ReactionFieldGeneralized</a>(   
<a name="l00081"></a>00081                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _prefactor,
<a name="l00082"></a>00082                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _kappa,
<a name="l00083"></a>00083                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _eps1,
<a name="l00084"></a>00084                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _eps2,
<a name="l00085"></a>00085                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _cutoff,
<a name="l00086"></a>00086                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _shift)
<a name="l00087"></a>00087                 : prefactor(_prefactor),kappa(_kappa),
<a name="l00088"></a>00088                   epsilon1(_eps1), epsilon2(_eps2),
<a name="l00089"></a>00089                   rc(_cutoff) {
<a name="l00090"></a>00090                     setShift(_shift);<span class="comment">//setShift(_shift);</span>
<a name="l00091"></a>00091                     setCutoff(_cutoff);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093                     initialize();
<a name="l00094"></a>00094                 }
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ab2437cbd67124c96c0af562b9d1ace2b">00096</a>                 <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html">ReactionFieldGeneralized</a>(
<a name="l00097"></a>00097                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _prefactor,
<a name="l00098"></a>00098                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _kappa,
<a name="l00099"></a>00099                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _eps1,
<a name="l00100"></a>00100                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _eps2,
<a name="l00101"></a>00101                         <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _cutoff)
<a name="l00102"></a>00102                 : prefactor(_prefactor), kappa(_kappa),
<a name="l00103"></a>00103                   epsilon1(_eps1), epsilon2(_eps2),
<a name="l00104"></a>00104                   rc(_cutoff) {
<a name="l00105"></a>00105                     autoShift = <span class="keyword">false</span>;
<a name="l00106"></a>00106                     setCutoff(_cutoff);
<a name="l00107"></a>00107                     <span class="comment">/*Note: AutoShift cannot be used here since the shift</span>
<a name="l00108"></a>00108 <span class="comment">                     *  has to depend on the product of charges */</span>
<a name="l00109"></a>00109                     <span class="comment">//setAutoShift();                 </span>
<a name="l00110"></a>00110                     initialize();
<a name="l00111"></a>00111                 }
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ab58a1f19f3f9de71fc3f8117564f3484">00113</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ab58a1f19f3f9de71fc3f8117564f3484">getKappa</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> kappa; }
<a name="l00114"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a330b6e01691935abd4b28dcb359db78f">00114</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a330b6e01691935abd4b28dcb359db78f">getEpsilon1</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> epsilon1; }
<a name="l00115"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a533416c73c4f4ccd6064f170d98fb180">00115</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a533416c73c4f4ccd6064f170d98fb180">getEpsilon2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> epsilon2; }
<a name="l00116"></a>00116 
<a name="l00117"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a809ae538b105326ae16e8ce1fe6c0d78">00117</a>                 <span class="keywordtype">void</span> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a809ae538b105326ae16e8ce1fe6c0d78">setCutoff</a>(<a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _cutoff) {
<a name="l00118"></a>00118                     cutoff = _cutoff;
<a name="l00119"></a>00119                     cutoffSqr = cutoff*cutoff;
<a name="l00120"></a>00120                     <span class="comment">//updateAutoShift();</span>
<a name="l00121"></a>00121                 }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123                 <span class="comment">// Setter and getter</span>
<a name="l00124"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#afe4c8544e33f5c903155bcf74d8a54ec">00124</a>                 <span class="keywordtype">void</span> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#afe4c8544e33f5c903155bcf74d8a54ec">setPrefactor</a>(<a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _prefactor) {
<a name="l00125"></a>00125                     prefactor = _prefactor;
<a name="l00126"></a>00126                     <span class="comment">//updateAutoShift();</span>
<a name="l00127"></a>00127                 }
<a name="l00128"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ad41b96eec7cd00d92ee7ac52556eb060">00128</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ad41b96eec7cd00d92ee7ac52556eb060">getPrefactor</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> prefactor; }
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 
<a name="l00131"></a>00131                 
<a name="l00132"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a858185d8d5ac8332ac5b06791f1e66b3">00132</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a858185d8d5ac8332ac5b06791f1e66b3">_computeEnergy</a>(<span class="keyword">const</span> <a class="code" href="structespressopp_1_1Particle.html">Particle</a>&amp; p1, <span class="keyword">const</span> <a class="code" href="structespressopp_1_1Particle.html">Particle</a>&amp; p2)<span class="keyword"> const </span>{
<a name="l00133"></a>00133                     <a class="code" href="classespressopp_1_1Real3D.html">Real3D</a> dist = p1.<a class="code" href="structespressopp_1_1Particle.html#a4c4adc50b426428a239c1de0248e3b5a">position</a>() - p2.<a class="code" href="structespressopp_1_1Particle.html#a4c4adc50b426428a239c1de0248e3b5a">position</a>();
<a name="l00134"></a>00134                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> distSqr = dist.<a class="code" href="classespressopp_1_1Real3D.html#a9eaf1e3703dd6a7e6e447b59eb98e553">sqr</a>();
<a name="l00135"></a>00135                     <span class="comment">//std::cout &lt;&lt; &quot;qq&quot; &lt;&lt; distSqr &lt;&lt; &quot; &quot; &lt;&lt; p1.id() &lt;&lt; &quot; &quot; &lt;&lt; p2.id() &lt;&lt; &quot;\n&quot;;</span>
<a name="l00136"></a>00136                     <span class="keywordflow">if</span> (distSqr&gt;rc2) <span class="keywordflow">return</span> 0.0;
<a name="l00137"></a>00137                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> qq = p1.<a class="code" href="structespressopp_1_1Particle.html#a1bc55db7845cfbac0ade14cef6a063e1">q</a>()*p2.<a class="code" href="structespressopp_1_1Particle.html#a1bc55db7845cfbac0ade14cef6a063e1">q</a>();
<a name="l00138"></a>00138                     <span class="comment">/* Note: this implementation counts minus integral of the force as energy</span>
<a name="l00139"></a>00139 <span class="comment">                         which is not the same as the full electrostatic energy</span>
<a name="l00140"></a>00140 <span class="comment">                         See the original paper Tironi et al, J. Chem. Phys. 102 , 5451 (1995) </span>
<a name="l00141"></a>00141 <span class="comment">                         for details*/</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143                     
<a name="l00144"></a>00144                     
<a name="l00145"></a>00145                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> energy = prefactor*qq * (1.0 / sqrt(distSqr) - B1_half*distSqr -crf);     
<a name="l00146"></a>00146                     <span class="keywordflow">return</span> energy;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148                     <span class="comment">// FORCE CAPPING HACK (was temporarily used for some ideal gas test simulations)</span>
<a name="l00149"></a>00149                     <span class="comment">/*real caprad = 0.1;</span>
<a name="l00150"></a>00150 <span class="comment">                    real capradSqr = caprad * caprad;</span>
<a name="l00151"></a>00151 <span class="comment">                    </span>
<a name="l00152"></a>00152 <span class="comment">                    if (distSqr &gt; capradSqr) {</span>
<a name="l00153"></a>00153 <span class="comment">                        real energy = prefactor*qq * (1.0 / sqrt(distSqr) - B1_half*distSqr -crf);     </span>
<a name="l00154"></a>00154 <span class="comment">                        return energy;                </span>
<a name="l00155"></a>00155 <span class="comment">                    }</span>
<a name="l00156"></a>00156 <span class="comment">                    else{</span>
<a name="l00157"></a>00157 <span class="comment">                        real energy = prefactor*qq * (1.0 / sqrt(capradSqr) - B1_half*capradSqr -crf);</span>
<a name="l00158"></a>00158 <span class="comment">                        real forcepart = prefactor*qq* (1.0/(caprad*capradSqr) + B1) *caprad;</span>
<a name="l00159"></a>00159 <span class="comment">                        real out = energy + forcepart*(caprad-sqrt(distSqr));</span>
<a name="l00160"></a>00160 <span class="comment">                        return out;                                        </span>
<a name="l00161"></a>00161 <span class="comment">                    }*/</span>
<a name="l00162"></a>00162              
<a name="l00163"></a>00163                 }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 
<a name="l00166"></a>00166                 <span class="comment">/*real _computeEnergySqrRaw(real distSqr) const {</span>
<a name="l00167"></a>00167 <span class="comment">                    return qq * (1.0 / sqrt(distSqr) + B0);</span>
<a name="l00168"></a>00168 <span class="comment">                }*/</span>
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 
<a name="l00171"></a>00171                 
<a name="l00172"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a544aa97392844d0c8df6121289882458">00172</a>                 <span class="keywordtype">bool</span> _computeForce(<a class="code" href="classespressopp_1_1Real3D.html">Real3D</a>&amp; force, <span class="keyword">const</span> <a class="code" href="structespressopp_1_1Particle.html">Particle</a> &amp;p1,
<a name="l00173"></a>00173                          <span class="keyword">const</span> <a class="code" href="structespressopp_1_1Particle.html">Particle</a> &amp;p2)<span class="keyword"> const </span>{
<a name="l00174"></a>00174                     <a class="code" href="classespressopp_1_1Real3D.html">Real3D</a> dist = p1.<a class="code" href="structespressopp_1_1Particle.html#a4c4adc50b426428a239c1de0248e3b5a">position</a>() - p2.<a class="code" href="structespressopp_1_1Particle.html#a4c4adc50b426428a239c1de0248e3b5a">position</a>();
<a name="l00175"></a>00175                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> r2 = dist.<a class="code" href="classespressopp_1_1Real3D.html#a9eaf1e3703dd6a7e6e447b59eb98e553">sqr</a>();
<a name="l00176"></a>00176                     <span class="keywordflow">if</span> (r2&gt;rc2) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00177"></a>00177                     
<a name="l00178"></a>00178                     
<a name="l00179"></a>00179                                       
<a name="l00180"></a>00180                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> r = sqrt(r2);
<a name="l00181"></a>00181                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> qq = p1.<a class="code" href="structespressopp_1_1Particle.html#a1bc55db7845cfbac0ade14cef6a063e1">q</a>()*p2.<a class="code" href="structespressopp_1_1Particle.html#a1bc55db7845cfbac0ade14cef6a063e1">q</a>();
<a name="l00182"></a>00182                     <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> ffactor = prefactor*qq* (1.0/(r*r2) + B1);
<a name="l00183"></a>00183                     force = dist * ffactor;
<a name="l00184"></a>00184                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00185"></a>00185                                
<a name="l00186"></a>00186                     <span class="comment">// FORCE CAPPING HACK (was temporarily used for some ideal gas test simulations)</span>
<a name="l00187"></a>00187                     <span class="comment">/*real caprad = 0.1;</span>
<a name="l00188"></a>00188 <span class="comment">                    real capradSqr = caprad * caprad;</span>
<a name="l00189"></a>00189 <span class="comment">                    real r = sqrt(r2);</span>
<a name="l00190"></a>00190 <span class="comment">                    real qq = p1.q()*p2.q();</span>
<a name="l00191"></a>00191 <span class="comment">                    </span>
<a name="l00192"></a>00192 <span class="comment">                    if (r2 &gt; capradSqr) {</span>
<a name="l00193"></a>00193 <span class="comment">                        real ffactor = prefactor*qq* (1.0/(r*r2) + B1);</span>
<a name="l00194"></a>00194 <span class="comment">                        force = dist * ffactor;</span>
<a name="l00195"></a>00195 <span class="comment">                        return true;                </span>
<a name="l00196"></a>00196 <span class="comment">                    }</span>
<a name="l00197"></a>00197 <span class="comment">                    else{</span>
<a name="l00198"></a>00198 <span class="comment">                        real ffactor = prefactor*qq* (1.0/(caprad*capradSqr) + B1);</span>
<a name="l00199"></a>00199 <span class="comment">                        force = dist * ffactor * (caprad/r);</span>
<a name="l00200"></a>00200 <span class="comment">                        //std::cout &lt;&lt; &quot;ReactionField, capped Force: &quot; &lt;&lt; sqrt(dist.sqr()) * ffactor * (caprad/r) &lt;&lt; &quot;\n&quot;; 0.1 LEADS TO 2492.93</span>
<a name="l00201"></a>00201 <span class="comment">                        return true;                                         </span>
<a name="l00202"></a>00202 <span class="comment">                    }*/</span>
<a name="l00203"></a>00203 
<a name="l00204"></a>00204                 }
<a name="l00205"></a>00205                 
<a name="l00206"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ad73d3ff7fde21a2d60973e4879f5f20c">00206</a>                 <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ad73d3ff7fde21a2d60973e4879f5f20c">_computeEnergySqrRaw</a>(<a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> distSqr)<span class="keyword"> const </span>{
<a name="l00207"></a>00207                         cout &lt;&lt; <span class="stringliteral">&quot;_computeEnergySqrRaw not possible for reaction field, no particle information&quot;</span> &lt;&lt; endl;
<a name="l00208"></a>00208                         exit(0);
<a name="l00209"></a>00209                         <span class="keywordflow">return</span> 0;
<a name="l00210"></a>00210                 }
<a name="l00211"></a><a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a7bc535e4f0280dbe2832bfee474a5fcf">00211</a>                 <span class="keywordtype">bool</span> <a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a7bc535e4f0280dbe2832bfee474a5fcf">_computeForceRaw</a>(<a class="code" href="classespressopp_1_1Real3D.html">Real3D</a>&amp; force, <span class="keyword">const</span> <a class="code" href="classespressopp_1_1Real3D.html">Real3D</a>&amp; dist, <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> distSqr)<span class="keyword"> const </span>{
<a name="l00212"></a>00212                         cout &lt;&lt; <span class="stringliteral">&quot;_computeEnergySqrRaw not possible for reaction field, no particle information&quot;</span> &lt;&lt; endl;
<a name="l00213"></a>00213                         exit(0);
<a name="l00214"></a>00214                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00215"></a>00215                 }
<a name="l00216"></a>00216                 <span class="comment">/*bool _computeForceRaw(Real3D&amp; force,</span>
<a name="l00217"></a>00217 <span class="comment">                        const Real3D&amp; dist, real distSqr) const {</span>
<a name="l00218"></a>00218 <span class="comment"></span>
<a name="l00219"></a>00219 <span class="comment">                    real r = sqrt(distSqr);</span>
<a name="l00220"></a>00220 <span class="comment">                    real ffactor = qq * ((1/(r*distSqr)) + B1);</span>
<a name="l00221"></a>00221 <span class="comment">                    force = dist * ffactor;</span>
<a name="l00222"></a>00222 <span class="comment"></span>
<a name="l00223"></a>00223 <span class="comment">                    return true;</span>
<a name="l00224"></a>00224 <span class="comment">                }*/</span>
<a name="l00225"></a>00225         };
<a name="l00226"></a>00226 
<a name="l00227"></a>00227         <span class="comment">// provide pickle support</span>
<a name="l00228"></a><a class="code" href="structespressopp_1_1interaction_1_1ReactionFieldGeneralized__pickle.html">00228</a>         <span class="keyword">struct </span><a class="code" href="structespressopp_1_1interaction_1_1ReactionFieldGeneralized__pickle.html">ReactionFieldGeneralized_pickle</a> : boost::python::pickle_suite
<a name="l00229"></a>00229         {
<a name="l00230"></a>00230           <span class="keyword">static</span>
<a name="l00231"></a>00231           boost::python::tuple
<a name="l00232"></a><a class="code" href="structespressopp_1_1interaction_1_1ReactionFieldGeneralized__pickle.html#a07afe7fca334c4dee9701edfa3056d87">00232</a>           getinitargs(<a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html">ReactionFieldGeneralized</a> <span class="keyword">const</span>&amp; pot)
<a name="l00233"></a>00233           {
<a name="l00234"></a>00234               <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _prefactor = pot.<a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ad41b96eec7cd00d92ee7ac52556eb060">getPrefactor</a>();
<a name="l00235"></a>00235               <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _kappa     = pot.<a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#ab58a1f19f3f9de71fc3f8117564f3484">getKappa</a>();
<a name="l00236"></a>00236               <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _eps1      = pot.<a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a330b6e01691935abd4b28dcb359db78f">getEpsilon1</a>();
<a name="l00237"></a>00237               <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> _eps2      = pot.<a class="code" href="classespressopp_1_1interaction_1_1ReactionFieldGeneralized.html#a533416c73c4f4ccd6064f170d98fb180">getEpsilon2</a>();
<a name="l00238"></a>00238               <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> rc         = pot.<a class="code" href="classespressopp_1_1interaction_1_1PotentialTemplate.html#a961c48e1d64c60ca3d96a74f63db686a">getCutoff</a>();
<a name="l00239"></a>00239               <a class="code" href="namespaceespressopp.html#a02c52392218b6989cf946062db1cd110">real</a> sh         = pot.<a class="code" href="classespressopp_1_1interaction_1_1PotentialTemplate.html#a34a58299634ae8b78d53d6a936dec3b4">getShift</a>();
<a name="l00240"></a>00240               <span class="keywordflow">return</span> boost::python::make_tuple(_prefactor, _kappa, _eps1, _eps2, rc, sh);
<a name="l00241"></a>00241           }
<a name="l00242"></a>00242         };
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245 }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 13 2016 22:17:26 for ESPResSo++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
