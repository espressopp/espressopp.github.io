

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>espressopp.analysis.RDFatomistic &mdash; ESPResSo++ vlatest</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon_blue.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="ESPResSo++ vlatest" href="index.html"/>
        <link rel="up" title="espressopp.analysis.Observable" href="espressopp.analysis.Observable.html"/>
        <link rel="next" title="espressopp.analysis.StaticStructF" href="espressopp.analysis.StaticStructF.html"/>
        <link rel="prev" title="espressopp.analysis.RadialDistrF" href="espressopp.analysis.RadialDistrF.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="http://www.espresso-pp.de/" class="icon icon-home"> ESPResSo++
            <a href="http://www.mpip-mainz.mpg.de/polymer_theory" style="font-size:90%">MPIP Mainz
          

          
            
            <!--<a href="http://www.mpip-mainz.mpg.de/polymer_theory"><img src="_static/logo_theory_group.png" class="logo"/></a>-->
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="instalation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="classdescription.html">User Interface</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="analysis.html">analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="bc.html">bc</a></li>
<li class="toctree-l2"><a class="reference internal" href="check.html">check</a></li>
<li class="toctree-l2"><a class="reference internal" href="esutil.html">esutil</a></li>
<li class="toctree-l2"><a class="reference internal" href="external.html">external</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrator.html">integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction.html">interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">io</a></li>
<li class="toctree-l2"><a class="reference internal" href="espressopp.html">espressopp</a></li>
<li class="toctree-l2"><a class="reference internal" href="standard_system.html">standard_system</a></li>
<li class="toctree-l2"><a class="reference internal" href="storage.html">storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging mechanism</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="doxygen.html">Doxygen</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdf.html">PDF Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ESPResSo++</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="classdescription.html">User Interface</a> &raquo;</li>
        
          <li><a href="analysis.html">analysis</a> &raquo;</li>
        
          <li><a href="espressopp.analysis.Observable.html">espressopp.analysis.Observable</a> &raquo;</li>
        
      <li>espressopp.analysis.RDFatomistic</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/espressopp.analysis.RDFatomistic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-espressopp.analysis.RDFatomistic"></span><div class="section" id="espressopp-analysis-rdfatomistic">
<h1>espressopp.analysis.RDFatomistic<a class="headerlink" href="#espressopp-analysis-rdfatomistic" title="Permalink to this headline">¶</a></h1>
<p>Class to compute radial distribution functions in adaptive resolution simulations in subregions of the box. Can be used for regular atomistic/coarse-grained (AT/CG) adaptive resolution simulations as well as path integral-based adaptive resolution simulations. The two functions (compute, computePathIntegral) exhibit different behavior.</p>
<p>The regular compute function is used for regular AT/CG simulations and there are two options:</p>
<p>Option 1 (spanbased = True): the RDF can be calculated in a cuboid region in the center of the box (periodic in y,z, limited in x). In this case, particle pairs are considered for which at least one of them is in the defined cuboid region. This can be useful when the high resolution region has a slab geometry. No further normalization should be required.</p>
<p>Option 2 (spanbased = False): the routine can also calculate unnormalized RDFs using particle pairs with both particles being in the high resolution region (based on the resolution value lambda, the span parameter is not used then). This can be useful when atomistic region has complicated or spherical geometries.</p>
<p>In any case, only pairs of atomistic particles belonging to two different coarse-grained particles are considered. Furthermore, note that the routine uses L_y / half (L_y is the box length in y-direction) as the maximum distance for the RDF calculation, which is then binned according to rdfN during the computation. Hence, L_y should be the shortest box side (or, equally short as L_x and/or L_z).</p>
<p>The computePathIntegral function is used for path integral-based adaptive resolution functions. It calculates the radial distribution functions over pairs of particles between different atoms or coarse-grained beads. Note, however, that in these types of quantum/classical adaptive resolution simulations, regular coarse-grained espressopp particles are associated with each atom and the additional “AdResS” atomistic particles correspond to the different Trotter beads. This means that the routine will, for molecules consisting of multiple atoms, calculate intramolecular rdfs, averaging over the Trotter bead pairs of the ring polymers, which represent the atoms. In doing so, it considers only particles pair with matching Trotter number and with the correct atomistic types. The results are averaged over all Trotter beads. Also in this case L_y / half (L_y is the box length in y-direction) is used as the maximum distance for the RDF calculation, which is then binned according to rdfN during the computation. Furthermore, the calculation is always “spanbased” in x direction (the function ignores the spanbased flag), but in such a fashion that BOTH particles need to be in the defined cuboid region. Normalization is performed as derived in R. Potestio et al., Phys. Rev. Lett. 111, 060601 (2013), Supp. Info. This means that, considering only particles with matching Trotter numbers, the computePathIntegral function calculates the RDF between particles of type A and B within a region bounded in x-direction by <span class="math">\(X_{min}\)</span> and <span class="math">\(X_{max}\)</span> as</p>
<div class="math">
\[ \begin{align}\begin{aligned}g_{slab}^{ab}(r^{AB}) = \sum_{a \in N^A} \sum_{b \in N^B} \frac{1}{ N^A N^B} \frac{\delta_\Delta(|\mathbf{r}_a - \mathbf{r}_b| - r)}{v(\mathbf{r}_a)/V_{slab}}\\\begin{split}\delta_\Delta(r) = \begin{cases} 1 \quad \textrm{for} \quad r&lt;\Delta \\ 0 \quad \textrm{otherwise} \end{cases}\end{split}\\v(\mathbf{r}_a)=2\pi\Delta \; r_a(2r_a-h(\mathbf{r}_a))\\h(\mathbf{r}_a) = (r_a - X^+)\theta(r_a - X^+) - (r_a - X^-)\theta(r_a - X^-)\\X^+ = X_{max} -x_a\\X^- = x_a - X_{min}\\\begin{split}\theta(r) = \begin{cases} 1 \quad \textrm{for} \quad r&gt;0 \\ 0 \quad \textrm{otherwise} \end{cases}\end{split}\end{aligned}\end{align} \]</div>
<p>where <span class="math">\(N^A\)</span> and <span class="math">\(N^B\)</span> are the number of particles of type A and B in the relevant subregion for the RDF calculation and <span class="math">\(V_{slab}\)</span> is the total volume of this subregion. Furthermore, <span class="math">\(r_a\)</span> denotes the radius of the spherical shell for the RDF calculation around particle <span class="math">\(a\)</span>, <span class="math">\(\Delta\)</span> is the thickness of the shell, and <span class="math">\(x_a\)</span> is the <span class="math">\(x\)</span> coordinate of particle <span class="math">\(a\)</span>. The final result is an average over all imaginary time slices (Trotter numbers).</p>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdf_0_1</span> <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">RDFatomistic</span><span class="p">(</span><span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="p">,</span> <span class="n">type1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">type2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spanbased</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">span</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># creates the class for calculating the RDF between atomistic particles of type 1 and 0 between different molecules,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># At least one of these particles has to be within plus/minus 1.5 from the center of the box in x-direction</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdf_0_1</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># computes the rdf using 100 bins over a distance corresponding to L_y / 2.0</span>
</pre></div>
</div>
<dl class="function">
<dt id="espressopp.analysis.RDFatomistic.espressopp.analysis.RDFatomistic">
<code class="descclassname">espressopp.analysis.</code><code class="descname">RDFatomistic</code><span class="sig-paren">(</span><em>system</em>, <em>type1</em>, <em>type2</em>, <em>spanbased</em>, <em>span</em><span class="sig-paren">)</span><a class="headerlink" href="#espressopp.analysis.RDFatomistic.espressopp.analysis.RDFatomistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the RDFatomistic object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>system</strong> (<em>shared_ptr&lt;System&gt;</em>) – system object</li>
<li><strong>type1</strong> (<em>int</em>) – type of atom 1</li>
<li><strong>type2</strong> (<em>int</em>) – type of atom 2</li>
<li><strong>spanbased</strong> (<em>bool</em>) – (default: True) If True, calculates RDFs in a cuboid region of radius span from the center (limited in x, periodic in y,z). If False, calculates RDFs with both particles being in the high resolution region (using lambda resolution values and ignoring span parameter).</li>
<li><strong>span</strong> (<em>real</em>) – (default: 1.0) +/- distance from centre of box in x-direction of the cuboid region used for RDF calculation if spanbased == True. If spanbased == False, this parameter is not used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="espressopp.analysis.RDFatomistic.espressopp.analysis.RDFatomistic.compute">
<code class="descclassname">espressopp.analysis.RDFatomistic.</code><code class="descname">compute</code><span class="sig-paren">(</span><em>rdfN</em><span class="sig-paren">)</span><a class="headerlink" href="#espressopp.analysis.RDFatomistic.espressopp.analysis.RDFatomistic.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the atomistic RDF assuming a regular atomistic/coarse-grained adaptive resolution setup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rdfN</strong> (<em>int</em>) – number of bins</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list of reals</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="espressopp.analysis.RDFatomistic.espressopp.analysis.RDFatomistic.computePathIntegral">
<code class="descclassname">espressopp.analysis.RDFatomistic.</code><code class="descname">computePathIntegral</code><span class="sig-paren">(</span><em>rdfN</em><span class="sig-paren">)</span><a class="headerlink" href="#espressopp.analysis.RDFatomistic.espressopp.analysis.RDFatomistic.computePathIntegral" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the path integral-based RDF averaging over all Trotter bead pairs with the same Trotter bead number between different ring polymers assuming a path integral-based quantum/classical adaptive resolution setup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rdfN</strong> (<em>int</em>) – number of bins</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list of reals</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="espressopp.analysis.StaticStructF.html" class="btn btn-neutral float-right" title="espressopp.analysis.StaticStructF" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="espressopp.analysis.RadialDistrF.html" class="btn btn-neutral" title="espressopp.analysis.RadialDistrF" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2018, Max Planck Institute for Polymer Research.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'latest',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>