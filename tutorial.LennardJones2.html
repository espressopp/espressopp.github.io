<div id="outer">

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Advanced Lennard Jones System &mdash; ESPResSo++ 1.7 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="ESPResSo++ 1.7 documentation" href="index.html" />
    <link rel="up" title="ESPResSo++ Tutorial" href="tutorial.html" />
    <link rel="next" title="Polymer Melt" href="tutorial.PolymerMelt.html" />
    <link rel="prev" title="Simple Lennard Jones System" href="tutorial.LennardJones.html" /> 
  </head>
  <body role="document">
  <div class="header"></div>


  
    <div class="menu">
      <ul class="nav">
	<li><a href="../index.html">Home</a></li>
	<li><a href="../Features.html">Features</a></li>
	<li><a href="../Download.html">Download</a></li>
	<li><a href="index.html">Documentation</a></li>
	<li><a href="../Developer_Team.html">Developer Team</a></li>
	<li><a href="../Getting_Help.html">Getting Help</a></li>
	<li id="impressum"><a href="../Impressum.html">Impressum</a></li>
      </ul>
      <div id="searchbox" style="display: none">
	<form class="search" action="search.html" method="get">
	  <input type="text" name="q" size="12" />
	  <input type="submit" value="Search" />
	  <input type="hidden" name="check_keywords" value="yes" />
	  <input type="hidden" name="area" value="default" />
	</form>
      </div>
      <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
   

  <div class="document">
      <div class="documentwrapper">
	<div class="bodywrapper">
	  <div class="body">
            
             <a href="tutorial.LennardJones.html">previous</a>
            
            
             <a style="float:right;"  href="tutorial.PolymerMelt.html">next</a>
            
	    
  <div class="section" id="advanced-lennard-jones-system">
<h1>Advanced Lennard Jones System<a class="headerlink" href="#advanced-lennard-jones-system" title="Permalink to this headline">Â¶</a></h1>
<p>This tutorial needs the matplotlib.pyplot and numpy libraries and also VMD to be installed.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">espressopp</span>
</pre></div>
</div>
<p>After importing espressopp we import several other Python packages that we want to
use for graphical output of some system parameters (e.g. temperature and energy)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;TkAgg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</pre></div>
</div>
<p>We setup a standard Lennard-Jones system with 1000 particles and a density of 0.85
in a cubic siomulation box. ESPResSo++ provides a &#8220;shortcut&#8221; to setup such a system:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span>   <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span> <span class="o">=</span> <span class="mf">0.85</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>   <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">rho</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="p">,</span> <span class="n">integrator</span> <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">standard_system</span><span class="o">.</span><span class="n">LennardJones</span><span class="p">(</span><span class="n">N</span><span class="p">,(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
</pre></div>
</div>
<p>We also add a Langevin thermostat:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">langevin</span> <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">LangevinThermostat</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">langevin</span><span class="o">.</span><span class="n">gamma</span>       <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">langevin</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrator</span><span class="o">.</span><span class="n">addExtension</span><span class="p">(</span><span class="n">langevin</span><span class="p">)</span>
</pre></div>
</div>
<p>We do a very short warmup in the beginning to get rid of &#8220;extremely&#8221; high forces</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">force_capping</span>   <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">CapForce</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="mf">1000000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrator</span><span class="o">.</span><span class="n">addExtension</span><span class="p">(</span><span class="n">force_capping</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">espressopp</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">analyse</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">integrator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">espressopp</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">analyse</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s initialize a graph. So that we can have a realtime-view on what is happening
in the simulation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</pre></div>
</div>
<p>We want to observe temperature and energy of the system:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span>   <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">Temperature</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span>   <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">EnergyPot</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">per_atom</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>x will be the x-axixs of the graph containg the time. yT and yE will be temperature
and energy as y-axes in 2 plots:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yT</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yE</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yTmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yEmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrator</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yTmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yEmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yE</span><span class="p">)</span>
</pre></div>
</div>
<p>Initialize the two graphs (&#8216;ro&#8217; means red circles, &#8216;go&#8217; means green cirlces, see also pyplot documentation)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gT</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yT</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gE</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yE</span><span class="p">,</span> <span class="s">&#39;go&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We also want to observe the configuration with VMD. So we have to connect to vmd. This command
will automatically start vmd (vmd has to be found in your PATH environment for this to work)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sock</span> <span class="o">=</span> <span class="n">espressopp</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">vmd</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">integrator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">espressopp</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">vmd</span><span class="o">.</span><span class="n">imd_positions</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">sock</span><span class="p">)</span>
</pre></div>
</div>
<p>Update the x-, and y-axes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span>  <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrator</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">yT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">yE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">yTmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">yEmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yE</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the temperature graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yTmin</span><span class="p">,</span> <span class="n">yTmax</span><span class="o">*</span><span class="mf">1.2</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">gT</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">yT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">gT</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the energy graph</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yEmin</span><span class="p">,</span> <span class="n">yEmax</span><span class="o">*</span><span class="mf">1.2</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">gE</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">yE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">gE</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>In the end save the equilibrated configurations as .eps and .pdf files</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;mypyplot.eps&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;mypyplot.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>


            
             <a href="tutorial.LennardJones.html">previous</a>
                
            
             <a style="float:right;"  href="tutorial.PolymerMelt.html">next</a>
            
          </div>
        </div>
     </div> 
 </div>
  </body>
</html>